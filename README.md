#include <stdio.h>
#include <stdlib.h>
#define TRUE 1
#define FALES 0
#include <locale.h>

int zachita(char a[9])
{
    int local2=0;
    if(a[1]=='X' && a[2]=='X' && a[3]=='_') {     /// 1 ������
        local2=3;
    } else if(a[1]=='X' && a[3]=='X' && a[2]=='_') {///1 ������
        local2=2;
    } else if(a[3]=='X' && a[2]=='X' && a[1]=='_') { ///1 ������
        local2=1;
    } else if(a[4]=='X' && a[5]=='X' && a[6]=='_') { ///2 ������
        local2=6;
    } else if(a[6]=='X' && a[5]=='X' && a[4]=='_') { ///2 ������
        local2=4;
    } else if(a[7]=='X' && a[8]=='X' && a[9]=='_') { ///3 ������
        local2=9;
    } else if(a[9]=='X' && a[8]=='X' && a[7]=='_') { ///3 ������
        local2=7;
    } else if(a[9]=='X' && a[7]=='X' && a[8]=='_') { ///3 ������
        local2=8;
    } else if(a[1]=='X' && a[4]=='X' && a[7]=='_') { ///1 �������
        local2=7;
    } else if(a[2]=='X' && a[5]=='X' && a[8]=='_') { /// 2 �������
        local2=8;
    } else if(a[5]=='X' && a[8]=='X' && a[2]=='_') { /// 2 �������
        local2=2;
    } else if(a[3]=='X' && a[6]=='X' && a[9]=='_') { ///3 �������
        local2=9;
    } else if(a[1]=='X' && a[7]=='X' && a[4]=='_') { /// 1 �������
        local2=4;
    } else if(a[3]=='X' && a[9]=='X' && a[6]=='_') { ///3 �������
        local2=6;
    } else if(a[7]=='X' && a[4]=='X' && a[1]=='_') { ///1 �������
        local2=1;
    } else if(a[9]=='X' && a[6]=='X' && a[3]=='_') { /// 3 �������
        local2=3;
    } else if(a[1]=='X' && a[5]=='X' && a[9]=='_') { /// �������� 1
        local2=9;
    } else if(a[9]=='X' && a[5]=='X' && a[1]=='_') { ///�������� 1.1
        local2=1;
    } else if(a[3]=='X' && a[5]=='X' && a[7]=='_') { ///�������� 2
        local2=7;
    } else if(a[7]=='X' && a[5]=='X' && a[3]=='_') { ///�������� 2.1
        local2=3;
    }
    return local2;
}
int pobeda(char a[9])
{
    int local=0;
    if(a[1]=='0' && a[2]=='0' && a[3]=='_') {     /// 1 ������
        local=3;
    } else if(a[1]=='0' && a[3]=='0' && a[2]=='_') {///1 ������
        local=2;
    } else if(a[3]=='0' && a[2]=='0' && a[1]=='_') { ///1 ������
        local=1;
    } else if(a[4]=='0' && a[5]=='0' && a[6]=='_') { ///2 ������
        local=6;
    } else if(a[6]=='0' && a[5]=='0' && a[4]=='_') { ///2 ������
        local=4;
    } else if(a[7]=='0' && a[8]=='0' && a[9]=='_') { ///3 ������
        local=9;
    } else if(a[9]=='0' && a[8]=='0' && a[7]=='_') { ///3 ������
        local=7;
    } else if(a[9]=='0' && a[7]=='0' && a[8]=='_') { ///3 ������
        local=8;
    } else if(a[1]=='0' && a[4]=='0' && a[7]=='_') { ///1 �������
        local=7;
    } else if(a[2]=='0' && a[5]=='0' && a[8]=='_') { /// 2 �������
        local=8;
    } else if(a[5]=='0' && a[8]=='0' && a[2]=='_') { /// 2 �������
        local=2;
    } else if(a[3]=='0' && a[6]=='0' && a[9]=='_') { ///3 �������
        local=9;
    } else if(a[1]=='0' && a[7]=='0' && a[4]=='_') { /// 1 �������
        local=4;
    } else if(a[3]=='0' && a[9]=='0' && a[6]=='_') { ///3 �������
        local=6;
    } else if(a[7]=='0' && a[4]=='0' && a[1]=='_') { ///1 �������
        local=1;
    } else if(a[9]=='0' && a[6]=='0' && a[3]=='_') { /// 3 �������
        local=3;
    } else if(a[1]=='0' && a[5]=='0' && a[9]=='_') { /// �������� 1
        local=9;
    } else if(a[9]=='0' && a[5]=='0' && a[1]=='_') { ///�������� 1.1
        local=1;
    } else if(a[3]=='0' && a[5]=='0' && a[7]=='_') { ///�������� 2
        local=7;
    } else if(a[7]=='0' && a[5]=='0' && a[3]=='_') { ///�������� 2.1
        local=3;
    }
    return local;
}

int vivod(char a[9])
{
    printf(" %c |",a[1]);
    printf(" %c |",a[2]);
    printf(" %c\n",a[3]);
    printf(" %c |",a[4]);
    printf(" %c |",a[5]);
    printf(" %c\n",a[6]);
    printf(" %c |",a[7]);
    printf(" %c |",a[8]);
    printf(" %c\n",a[9]);
}

int vivodp (char a[9])
{
    return(a[1]!='_' && a[1]==a[2] && a[2]==a[3])||
          (a[4]!='_' && a[4]==a[5] && a[5]==a[6])||
          (a[7]!='_' && a[7]==a[8] && a[8]==a[9])||
          (a[1]!='_' && a[1]==a[5] && a[5]==a[9])||
          (a[3]!='_' && a[3]==a[5] && a[5]==a[7])||
          (a[1]!='_' && a[1]==a[4] && a[4]==a[7])||
          (a[2]!='_' && a[2]==a[5] && a[5]==a[8])||
          (a[3]!='_' && a[3]==a[6] && a[6]==a[9]);

}

int main(int argc, char *argv[])
{
	

setlocale(LC_ALL, "Rus");
    int vozvrat=0,vozvrat2=0,s=1,st=0;
    char x,a[9]= {'_','_','_','_','_','_','_','_','_',};
    a[9]='_';
    int ich=0,ich1=0,ich2=0,i1=0;
    puts("Developer Edward Enterprise with the support of a Specialist them.Bauman and Economic business College.\n");
    puts("���� �������� �� ������ �� ��� ++  � #.\n");
    for(int i=1; i<=4; i++) {
        if(vozvrat2 >0) {
            break;
        }
        do {
            printf("������� ����� ��������� ������ ��� X �� 1 �� 9\n");
            scanf("%d",&x);
            printf("����� ������ %d\n",x);
             if(a[x]=='_') {
                a[x]='X';
                vivod(a);
                vozvrat2 = vivodp(a);
                if(vozvrat2) {
                    puts("������� � !");
                }
                break;
            } else {
                printf("������ ������\n");
            }
        } while(TRUE);
        if(vozvrat2 >0) {
            break;
        }
        puts("��� ��");
        switch(i) {
        case 1:
            if(a[5]=='X') {
                a[9]='0';
            } else {
                a[5]='0';
            }
            vivod(a);
            break;
        case 2:     //2 ���
            vozvrat=zachita(a);
            if(vozvrat > 0) {
                a[vozvrat]='0';
            }
            if(vozvrat==0) {
                if(a[4]=='X' && a[6]=='X' && a[5]=='0' && a[2]=='_') {
                    a[2]='0';
                } else if(a[1]=='X' && a[9]=='X' && a[5]=='0' && a[8]=='_') {
                    a[8]='0';
                } else if(a[1]=='X' && a[6]=='X' && a[5]=='0' && a[8]=='_') {
                    a[8]='0';
                } else if(a[7]=='X' && a[4]=='X' && a[1]=='_') { ///������ 1 �������
                    a[1]='0';
                } else if(a[3]=='X' && a[8]=='X' && a[6]=='_') { ///������ �� �������� 3 �������
                    a[6]='0';
                } else if(a[2]=='X' && a[5]=='X' && a[3]=='_') { ///������ �� 2 ���������
                    a[8]='0';
                } else if(a[1]=='X' && a[8]=='X' && a[7]=='_') { ///  ������ �� 1 ���������
                    a[7]='0';
                }  else if(a[3]=='X' && a[4]=='X' && a[1]=='_') { /// ������ �� 3 ���������
                    a[1]='0';
                } else if(a[3]=='X' && a[7]=='X' && a[8]=='_') { ///������ �� 2 ��������
                    a[8]='0';
                }  else if(a[5]=='X' && a[9]=='X' && a[3]=='_') { ///
                    a[3]='0';
                } else if(a[5]=='X' && a[1]=='X' && a[3]=='_') { ///
                    a[3]='0';
                } else if(a[2]=='X' && a[9]=='X' && a[3]=='_') { ///������ �� 1 ��������
                    a[3]='0';
                } else if(a[2]=='X' && a[4]=='X' && a[1]=='_') { ///������ �� 1 ��������
                    a[1]='0';
                } else if(a[2]=='X' && a[6]=='X' && a[3]=='_') { ///������ �� 1 ��������
                    a[3]='0';
                } else if(a[2]=='X' && a[7]=='X' && a[4]=='_') { ///������ �� 1 ��������
                    a[4]='0';
                } else if(a[2]=='X' && a[8]=='X' && a[1]=='_') { ///������ �� 1 ��������
                    a[1]='0';
                } else if(a[4]=='X' && a[8]=='X' && a[7]=='_') { ///������ �� 1 ��������
                    a[7]='0';
                } else if(a[4]=='X' && a[9]=='X' && a[2]=='_') { ///������ �� 1 ��������
                    a[2]='0';
                } else if(a[6]=='X' && a[7]=='X' && a[8]=='_') { ///������ �� 1 ��������
                    a[8]='0';
                } else if(a[6]=='X' && a[8]=='X' && a[9]=='_') { ///������ �� 1 ��������
                    a[9]='0';
                } else if (a[5]=='0') {
                     if(a[1]=='_' ) {
                        a[1]='0';
                    } else if(a[2]=='_' ) {
                        a[2]='0';
                    } else if(a[3]=='_' ) {
                        a[3]='0';
                    } else if(a[4]=='_' ) {
                        a[4]='0';
                    } else if(a[5]=='_' ) {
                        a[5]='0';
                    } else if(a[6]=='_' ) {
                        a[6]='0';
                    } else if(a[7]=='_' ) {
                        a[7]='0';
                    } else if(a[8]=='_' ) {
                        a[8]='0';
                    } else if(a[9]=='_' ) {
                        a[9]='0';
                    }
                }
            }
            vivod(a);
            break;
        case 3:            //3 ���
            vozvrat=pobeda(a);
            if(vozvrat > 0) {
                a[vozvrat]='0';
            } else {
            vozvrat=zachita(a);
            if(vozvrat > 0) {
                a[vozvrat]='0';
            }
            if(vozvrat==0){
                //����� ���������� ��������
                if(a[4]=='X'&& a[3]=='X' && a[9]=='X' && a[1]=='_' ) { /// ������ �� ���������
                    a[1]='0';
                    st=1;
                } else  if(a[2]=='X' && a[7]=='X'&& a[9]=='X' && a[1]=='0' && a[5]=='0' && a[8]=='_' ) { /// ������ �� ���������
                    a[8]='0';
                    st=1;
                } else if(a[7]=='X' && a[9]=='X' && a[8]=='_') { /// ������ �� ���������
                    a[8]='0';
                    st=1;
                } else if(a[5]=='X' && a[6]=='X' && a[7]=='X' && a[3]=='0' &&  a[9]=='0' && a[4]=='_') { /// ������ �� ���������
                    a[4]='0';
                    st=1;
                } else if(a[7]=='X' && a[5]=='X'&& a[3]=='_') { /// ������ �� ���������
                    a[3]='0';
                    st=1;
                } else if(a[3]=='X' && a[5]=='X' && a[1]=='X' && a[2]=='_') { /// ������ �� ���������
                    a[2]='0';
                    st=1;
                } else if(a[9]=='X' && a[5]=='X' && a[1]=='_') { /// ������ �� ���������
                    a[1]='0';
                    st=1;
                } else if(a[2]=='0' && a[8]=='_') { /// ������ �� ���������
                    a[8]='0';
                    st=1;
                } else if(a[1]=='X' && a[3]=='X' && a[5]=='X' && a[2]=='_') { /// ������ �� ���������
                    a[2]='0';
                    st=1;
                } else if(a[4]=='0' && a[9]=='0' && a[3]=='X' && a[5]=='X' && a[6]=='X' && a[7]=='_') { /// ������ �� ���������
                    a[7]='0';
                    st=1;
                } else if(a[1]=='X' && a[7]=='X' && a[4]=='_') { /// ������ �� ���������
                    a[4]='0';
                    st=1;
                } else if(a[9]=='X' && a[3]=='X') { /// ������ �� ���������
                    a[6]='0';
                    st=1;
                }
                //������ �� ���������
                if(st==0) {
                    //x ����� � 1 � 2 � 3 ������� ��������
                    if(a[1]=='X' && a[2]=='X' && a[3]=='_') {
                        a[3]='0';
                        st=1;
                    }
                    //0 ����� � 1 � � 3 � 2 ������ ��������
                    else if (a[1]=='X' && a[3]=='X' && a[2]=='_') {
                        a[2]='0';
                        st=1;
                    }
                    //x ����  � 1 � 4 ������ � �������� 7
                    else if(a[1]=='X' && a[4]=='X' && a[7]=='_') {
                        a[7]='0';
                        st=1;
                    }
                    //x ����� � 1 � 7 ������ � �������� 4
                    else if(a[1]=='X' && a[7]=='X' && a[4]=='_') {
                        a[4]='0';
                        st=1;
                    }
                    //x ����� � 3 � 6 ������ � �������� 9

                    else if(a[3]=='X' && a[6]=='X' && a[9]=='_') {
                        a[9]='0';
                        st=1;
                    }
                    //x ����� � 3 � 9 ������ � �������� 6
                    else if(a[3]=='X' && a[9]=='X' && a[6]=='_') {
                        a[6]='0';
                        st=1;
                    }
                    //x ����� � 9 � 6 ������ � �������� 3
                    else if(a[9]=='X' && a[6]=='X' && a[3]=='_') {
                        a[3]='0';
                        st=1;
                    }
                    //x ����� � 7 � 8 ������ � �������� 9
                    else if(a[7]=='X' && a[8]=='X' && a[9]=='_') {
                        a[9]='0';
                        st=1;
                    }
                    //x ����� � 7 � 9 ������ � �������� 8
                    else if(a[7]=='X' && a[9]=='X' && a[8]=='_') { /// ������ �� ���������
                        a[8]='0';
                        st=1;
                    } else if(a[8]=='X' && a[9]=='X' && a[7]=='_') { /// ������ �� ���������
                        a[7]='0';
                        st=1;
                    } else if(a[2]=='X' && a[9]=='X' && a[7]=='_') { /// ������ �� ���������
                        a[7]='0';
                        st=1;
                    } else if(a[3]=='X' && a[9]=='X' && a[6]=='_') { /// ������ �� ���������
                        a[6]='0';
                        st=1;
                    } else if(a[4]=='X' && a[5]=='X' && a[6]=='_') { /// ������ �� ���������
                        a[6]='0';
                        st=1;
                    } else if(a[3]=='X' && a[9]=='X' && a[6]=='_') { /// ������ �� ���������
                        a[6]='0';
                        st=1;
                    } else if(a[2]=='X' && a[5]=='X' && a[8]=='_') { /// ������ �� ���������
                        a[8]='0';
                        st=1;
                    } else if(a[8]=='X' && a[1]=='X' && a[6]=='_') { /// ������ �� ���������
                        a[6]='0';
                        st=1;
                    } else if(a[5]=='0' && a[4]=='0' && a[2]=='X' && a[6]=='X' && a[7]=='X' && a[3]=='_') { /// ������ �� ���������
                        a[3]='0';
                        st=1;
                    }

                    else if(a[1]=='X' && a[6]=='X' && a[7]=='X' && a[5]=='0' && a[4]=='0' && a[2]=='_') {  /// ������ �� ���������
                        a[2]='0';
                        st=1;
                    } else if(a[6]=='X'  && a[5]=='X'  && a[4]=='_') { /// ������ �� ���������
                        a[4]='0';
                        st=1;
                    } else if(a[8]=='X'  && a[5]=='X'  && a[2]=='_') { /// ������ �� ���������
                        a[2]='0';
                        st=1;
                    } else if(a[3]=='X'  && a[5]=='X'  && a[7]=='_') { ///���������� ��������
                        a[7]='0';
                        st=1;
                    } else if(a[2]=='X'  && a[6]=='X'  && a[7]=='X' && a[3]=='0' && a[5]=='0' && a[1]=='_') { ///���������� ��������
                        a[1]='0';
                        st=1;
                    } else if(a[3]=='X'  && a[4]=='X'  && a[8]=='X' && a[5]=='0' && a[6]=='0' && a[1]=='_') { ///���������� ��������
                        a[1]='0';
                        st=1;
                    } else if(a[4]=='X'  && a[6]=='X'  && a[8]=='X' && a[5]=='0' && a[2]=='0' && a[9]=='_') { ///���������� ��������
                        a[9]='0';
                        st=1;
                    } else if(a[4]=='X'  && a[3]=='X'  && a[8]=='X' && a[5]=='0' && a[7]=='0' && a[1]=='_') { ///���������� ��������
                        a[1]='0';
                        st=1;
                    } else if(a[7]=='X'  && a[6]=='X'  && a[2]=='X' && a[5]=='0' && a[8]=='0' && a[1]=='_') { ///���������� ��������
                        a[1]='0';
                        st=1;
                    } else if(a[8]=='X'  && a[6]=='X'  && a[1]=='X' && a[5]=='0' && a[9]=='0' && a[3]=='_') { ///���������� ��������
                        a[3]='0';
                        st=1;
                    } else if(a[2]=='X'  && a[7]=='X'  && a[9]=='X' && a[5]=='0' && a[8]=='0' && a[4]=='_') { ///���������� ��������
                        a[4]='0';
                        st=1;
                    }else if (a[5]=='0') {
                     if(a[1]=='_' ) {
                        a[1]='0';
                    } else if(a[2]=='_' ) {
                        a[2]='0';
                    } else if(a[3]=='_' ) {
                        a[3]='0';
                    } else if(a[4]=='_' ) {
                        a[4]='0';
                    } else if(a[5]=='_' ) {
                        a[5]='0';
                    } else if(a[6]=='_' ) {
                        a[6]='0';
                    } else if(a[7]=='_' ) {
                        a[7]='0';
                    } else if(a[8]=='_' ) {
                        a[8]='0';
                    } else if(a[9]=='_' ) {
                        a[9]='0';
                    }
                }
                }
                vozvrat=zachita(a);
                if(vozvrat > 0) {
                    a[vozvrat]='0';
                }
                }
            }
            vivod(a);
            vozvrat2 =vivodp(a);
                if(vozvrat2) {
                    puts("������� 0 !");
                  break;
                }

            break;
        case 4:
            vozvrat=pobeda(a);
            if(vozvrat > 0) {
                a[vozvrat]='0';
            } else {
              vozvrat=zachita(a);
            if(vozvrat > 0) {
                a[vozvrat]='0';
            }
            if(vozvrat==0){
                st=0;
                if(a[1]=='X'&& a[3]=='X' && a[5]=='X' && a[8]=='X' && a[2]=='0' && a[7]=='0' && a[9]=='0' && a[6]=='_') {
                    a[6]='0';
                    st=1;
                } /// ������
                if(st==0) {
                      if(a[4]=='X' && a[5]=='X' && a[3]=='_') { /// ������
                        a[3]='0';
                        st=1;
                    } else if(a[2]=='X' && a[5]=='X' && a[4]=='_') { /// ������
                        a[4]='0';
                        st=1;
                    } else if(a[1]=='X' && a[4]=='X' && a[7]=='_') { /// ������
                        a[7]='0';
                        st=1;
                    } else if(a[3]=='X' && a[8]=='X' && a[9]=='_') { /// ������
                        a[9]='0';
                        st=1;
                    } else if(a[3]=='X' && a[9]=='X' && a[6]=='_') { ///������
                        a[6]='0';
                        st=1;
                    }  else if(a[7]=='X' && a[9]=='X' && a[8]=='_') { ///������
                        a[8]='0';
                        st=1;
                    } else if(a[2]=='X' && a[6]=='X' && a[9]=='X'&& a[2]=='_') { ///������
                        a[2]='0';
                        st=1;
                    } else if(a[7]=='X' && a[4]=='X' && a[1]=='_') { ///������
                        a[1]='0';
                        st=1;
                    } else if(a[2]=='X' && a[9]=='X' && a[3]=='_') { ///������
                        a[3]='0';
                        st=1;
                    } else if(a[7]=='X' && a[8]=='X' && a[9]=='_') { ///������
                        a[9]='0';
                        st=1;
                    } else if(a[2]=='X' && a[7]=='X' && a[1]=='_') { ///������
                        a[1]='0';
                        st=1;
                    } else if(a[3]=='X' && a[6]=='X' && a[9]=='_') { ///������
                        a[9]='0';
                        st=1;
                    } else if(a[9]=='X' && a[8]=='_') { /// ������
                        a[8]='0';
                        st=1;
                    } else if(a[7]=='X' && a[8]=='_') { /// ������
                        a[8]='0';
                        st=1;
                    } else if(a[1]=='X' && a[4]=='X'&& a[7]=='_') {
                        a[7]='0';
                        st=1;
                    } else if(a[8]=='X'&& a[9]=='X' && a[7]=='_') {
                        a[7]='0';
                        st=1;
                    } else if(a[3]=='X'&& a[2]=='X' && a[1]=='_') {
                        a[1]='0';
                        st=1;
                    } else if(a[1]=='X'&& a[2]=='X' && a[4]=='X' && a[7]=='_') {
                        a[7]='0';
                        st=1;
                    } else if(a[1]=='X'&& a[6]=='X' && a[7]=='X' && a[8]=='X' && a[5]=='0' && a[4]=='0' && a[9]=='0' && a[2]=='_') {
                        a[2]='0';
                        st=1;
                    } else if(a[1]=='X'&& a[7]=='X' && a[4]=='_') {
                        a[4]='0';
                        st=1;
                    } else if(a[4]=='X'&& a[7]=='_') {
                        a[7]='0';
                        st=1;
                    } else if(a[8]=='X'&& a[7]=='_') {
                        a[7]='0';
                        st=1;
                    } else if(a[5]=='X'&& a[3]=='X' && a[7]=='_') {
                        a[7]='0';
                        st=1;
                    } else if(a[3]=='X'  && a[4]=='X'  && a[9]=='X' && a[8]=='X' && a[5]=='0' && a[6]=='0' && a[7]=='0' && a[2]=='_') { ///���������� ��������
                        a[2]='0';
                        st=1;
                    } else if (a[5]=='0') {
                     if(a[1]=='_' ) {
                        a[1]='0';
                    } else if(a[2]=='_' ) {
                        a[2]='0';
                    } else if(a[3]=='_' ) {
                        a[3]='0';
                    } else if(a[4]=='_' ) {
                        a[4]='0';
                    } else if(a[5]=='_' ) {
                        a[5]='0';
                    } else if(a[6]=='_' ) {
                        a[6]='0';
                    } else if(a[7]=='_' ) {
                        a[7]='0';
                    } else if(a[8]=='_' ) {
                        a[8]='0';
                    } else if(a[9]=='_' ) {
                        a[9]='0';
                    }
                }
                    vozvrat=zachita(a);
                    if(vozvrat > 0) {
                        a[vozvrat]='0';
                    }

                }
                if(st) {
                    vozvrat=vivodp(a);
                }
                }
            }
            vivod(a);
            vozvrat2=vivodp(a);
            if(vozvrat2) {
            puts("������� 0 !");
            break;
        }
        default:
            break;
        }
   	}
    if(vozvrat2==0){

        printf("�������� ��������� �������\n");
        for(int i=1; i<=9; i++) {
            if(a[i]=='_') {
                a[i]='X';
                vivod(a);
                vozvrat2 =vivodp(a);
                if(vozvrat2) {
                    puts("������� � !");
                }
                break;
            }
        }
    } 

    if(vozvrat2==0) {
        printf("�����\n");
    }
	system("pause");
    return 0;
}
